<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Flappy Bird â€“ Upgraded</title>
<style>
  * { box-sizing: border-box; }
  body {
    margin: 0;
    background: #70c5ce;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    font-family: Arial, sans-serif;
  }
  #game {
    position: relative;
    width: 400px;
    height: 600px;
    overflow: hidden;
    border-radius: 12px;
    background: linear-gradient(#70c5ce, #c0f4ff);
  }
  #bg {
    position: absolute;
    width: 800px;
    height: 600px;
    left: 0;
    top: 0;
    background: repeating-linear-gradient(
      to right,
      #9be7ff 0,
      #9be7ff 40px,
      #87dfff 40px,
      #87dfff 80px
    );
    animation: bgMove 20s linear infinite;
  }
  @keyframes bgMove {
    from { transform: translateX(0); }
    to { transform: translateX(-400px); }
  }
  #ground {
    position: absolute;
    bottom: 0;
    height: 100px;
    width: 800px;
    background: repeating-linear-gradient(
      to right,
      #d9b38c 0,
      #d9b38c 40px,
      #c69c6d 40px,
      #c69c6d 80px
    );
    animation: groundMove 2s linear infinite;
  }
  @keyframes groundMove {
    from { transform: translateX(0); }
    to { transform: translateX(-400px); }
  }
  #bird {
    position: absolute;
    width: 40px;
    height: 30px;
    background: radial-gradient(circle at 10px 10px, #fff 0, #ffd400 40%, #ffb300 100%);
    border-radius: 50% 50% 45% 45%;
    left: 80px;
    top: 250px;
    transform-origin: center;
  }
  .pipe {
    position: absolute;
    width: 60px;
    background: linear-gradient(#4CAF50, #2e7d32);
    border-radius: 6px;
  }
  #score {
    position: absolute;
    top: 10px;
    left: 10px;
    color: #fff;
    font-size: 22px;
    font-weight: bold;
    text-shadow: 1px 1px 2px #000;
  }
  #high {
    position: absolute;
    top: 10px;
    right: 10px;
    color: #fff;
    font-size: 16px;
    text-shadow: 1px 1px 2px #000;
  }
  #overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.35);
    display: flex;
    justify-content: center;
    align-items: center;
    color: #fff;
    text-align: center;
    font-size: 26px;
    display: none;
  }
  #overlay small { display:block; font-size:14px; margin-top:10px; }
</style>
</head>
<body>

<div id="game">
  <div id="bg"></div>
  <div id="bird"></div>
  <div id="ground"></div>
  <div id="score">0</div>
  <div id="high">High: 0</div>
  <div id="overlay">Game Over<br/><small>Click or Press Space to Restart</small></div>
</div>

<script>
  const game = document.getElementById('game');
  const bird = document.getElementById('bird');
  const scoreEl = document.getElementById('score');
  const highEl = document.getElementById('high');
  const overlay = document.getElementById('overlay');

  let birdY = 250;
  let velocity = 0;
  const gravity = 0.6;
  const jumpPower = -10;
  let running = true;
  let score = 0;
  let highScore = localStorage.getItem('flappyHigh') || 0;
  highEl.innerText = 'High: ' + highScore;

  function reset() {
    document.querySelectorAll('.pipe').forEach(p => p.remove());
    birdY = 250; velocity = 0; score = 0;
    scoreEl.innerText = '0';
    overlay.style.display = 'none';
    running = true;
  }

  function flap() {
    if (!running) { reset(); return; }
    velocity = jumpPower;
  }

  document.addEventListener('keydown', e => { if (e.code === 'Space') flap(); });
  document.addEventListener('click', flap);

  function createPipe() {
    if (!running) return;
    const gap = 150;
    const topH = Math.random() * 200 + 50;

    const top = document.createElement('div');
    const bottom = document.createElement('div');
    top.className = bottom.className = 'pipe';

    top.style.height = topH + 'px';
    top.style.top = '0';
    bottom.style.height = (600 - topH - gap - 100) + 'px';
    bottom.style.bottom = '100px';

    let x = 400;
    top.style.left = bottom.style.left = x + 'px';

    game.appendChild(top); game.appendChild(bottom);

    const move = setInterval(() => {
      if (!running) { clearInterval(move); return; }
      x -= 2.5;
      top.style.left = bottom.style.left = x + 'px';

      // collision
      if (x < 120 && x > 40) {
        if (birdY < topH || birdY + 30 > topH + gap) end();
      }

      if (x === 80) {
        score++;
        scoreEl.innerText = score;
      }

      if (x < -60) {
        top.remove(); bottom.remove(); clearInterval(move);
      }
    }, 20);
  }

  function end() {
    running = false;
    overlay.style.display = 'flex';
    if (score > highScore) {
      highScore = score;
      localStorage.setItem('flappyHigh', highScore);
      highEl.innerText = 'High: ' + highScore;
    }
  }

  setInterval(() => {
    if (!running) return;
    velocity += gravity;
    birdY += velocity;
    bird.style.top = birdY + 'px';
    bird.style.transform = 'rotate(' + Math.min(velocity * 3, 30) + 'deg)';

    if (birdY < 0 || birdY > 470) end();
  }, 20);

  setInterval(createPipe, 1800);
</script>
</body>
</html>
